---
import { Image } from 'astro:assets'

import SocialIcons from './SocialIcons.astro'

import SocialIcons from "./SocialIcons.astro";
import { selfDescription } from "../../data/cv_plain";

type LinkDef = {
  match: string;
  url: string;
};

function applyLinks(text: string, links: LinkDef[]): string {
  let result = text;
  for (const link of links) {
    const escaped = link.match.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
    const regex = new RegExp(escaped, "g");
    result = result.replace(
      regex,
      `<a href="${link.url}" style="color:blue">${link.match}</a>`
    );
  }
  return result;
}

const heroHTML = applyLinks(selfDescription.text.trim(), selfDescription.links);
const {fullName, title, institute, profilePicture} = Astro.props
---
<div class='flex-1'>
  <h1 class='text-4xl font-bold mb-4'>
    Hi! I'm <span class='text-secondary'>{fullName}</span>
  </h1>
  <p class='text-xl text-gray-600 mb-4'>{title}{institute ? ` at ${institute}` : ''}</p>
  <p class="text-lg mb-6" set:html={heroHTML}></p>
  <div class='flex gap-4'>
    <SocialIcons />
  </div>
</div>
<div class='size-72 lg:block hidden'>
  <!-- Add your profile image -->
  <Image
    src={profilePicture}
    alt={fullName}
    class='w-full h-full mask mask-circle size-44'
  />
</div>
